
<!DOCTYPE html>
<html dir="rtl" lang="ar">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <title>Upload Files</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: "Montserrat", sans-serif;
            font-optical-sizing: auto;
            font-style: normal;
        }
        @-webkit-keyframes rotate {
            from {
                -webkit-transform: rotate(0deg);
                -o-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            to {
                -webkit-transform: rotate(360deg);
                -o-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        @keyframes rotate {
            from {
                -ms-transform: rotate(0deg);
                -moz-transform: rotate(0deg);
                -webkit-transform: rotate(0deg);
                -o-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            to {
                -ms-transform: rotate(360deg);
                -moz-transform: rotate(360deg);
                -webkit-transform: rotate(360deg);
                -o-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        body {
            margin: 0;
            padding: 1rem;
            background-color: #0679e4;
        }
        .upload-form {
            display: flex;
            max-width: 50vw;
            padding: 100px;
            flex-flow: column;
            margin: 100px auto 1rem auto;
            background-color: #fff;
            box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.15);
        }
        .upload-form h1 {
            margin: 0;
            padding: 1rem 0px 0.5rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: #434850;
            text-align: left;
        }
        .upload-form label {
            display: flex;
            flex-flow: column;
            justify-content: center;
            align-items: center;
            border: 1px dashed #ece6e9;
            color: #000000;
            padding: 0.5rem 0.75rem;
            font-weight: 500;
            font-size: 0.875rem;
            margin: 0.5rem 0;
            border-radius: 0.25rem;
            cursor: pointer;
        }
        .upload-form label i {
            padding: 0.25rem 0;
            color: #0c7ce5;
        }
        .upload-form label span {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            word-break: break-all;
        }
        .upload-form label:hover {
            background-color: #f7f8f9;
            border: 1px dashed #e3e5ea;
        }
        .upload-form input[type="file"] {
            appearance: none;
            visibility: hidden;
            height: 0;
            width: 0;
            padding: 0;
            margin: 0;
        }
        .upload-form .result {
            display: flex;
            background: #ecf6ff;
            border-radius: 0.25rem;
            gap: 0.5rem;
            padding: 0.5rem
        }
        .upload-form .result * {
            font-size: 0.5rem;
        }
        .upload-form .result .ph-file {
            font-size: 1.5rem;
        }
        .upload-form .result span {
            display: block;
        }
        .upload-form .result .file-details {
            display: flex;
            flex-flow: column;
            justify-content: center;
            align-items: flex-start;
            gap: 0.25rem;
            flex: 1
        }
        .upload-form .result .file-details span.file-name {
            color: #000000;
            font-weight: 600;
        }
        .upload-form .result .file-details span.file-size {
            color: #a0aeba;
        }
        .upload-form .result .progress-bar {
            width: 100%;
            height: 0.25rem;
            background-color: #e3e5ea;
            border-radius: 0.25rem;
            overflow: hidden;
        }
        .upload-form .result .progress-bar .progress {
            height: 100%;
            background-color: #0c7ce5;
        }
        .upload-form .result .upload-result {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 0.25rem;
        }
        .upload-form .result .upload-result .ph-circle-notch {
            -webkit-animation: rotate 2s linear infinite;
            -moz-animation: rotate 2s linear infinite;
            -ms-animation: rotate 2s linear infinite;
            -o-animation: rotate 2s linear infinite;
            animation: rotate 2s linear infinite;
            font-size: 1rem;
        }
        .upload-form .result .upload-result .ph-check-circle {
            color: #23c925;
            font-size: 1rem;
        }
        .upload-form .result .upload-result .ph-x-circle {
            color: #c94647;
            font-size: 1rem;
        }
    </style>
</head>

<body>
    
    <form id="uploadForm" action="http://localhost:3000/" enctype="multipart/form-data">
        <label> اسم الشريكة </label>
        <input type="text" name="fName" placeholder=" ادخل اسم الشريكة" />
        <br>
        <label> الملاحظات </label>
        <input type="text" name="lName" placeholder=" ادخل الملاحظات" />
        <br><br>
        <label for="file">
            <i class="ph ph-upload"></i>
            <span> Drag & drop or <span style="color: #030303; display: inline-block; margin: 0px 2px;">browse</span>
                your files </span>
        </label>
        <input type="file" id="fileInput" name="files[]" multiple accept="image/*,.pdf"/>
        <br><br>
        <div class="result" style="display: none;">
            <i class="ph ph-file"></i>
            <div class="file-details">
                <span class="file-name"></span>
                <span class="file-size"></span>
            </div>
            <div class="upload-result"></div>
        </div>
        <br><br>
        <button type="button" id="uploadButton">Upload Files</button>
    </form>
   
  <script type="text/javascript">

    // Add Event Listener to the button element
    /* 
        When our form’s upload button is clicked, 
        the Event Listener will trigger the "uploadFiles" function, 
        which is responsible for handling the file upload process, 
        including preparing the files for upload and sending them to the server. 
    */
    // following is an Event listener
    const uploadButton = document.getElementById("uploadButton"); 
            uploadButton.addEventListener("click", uploadFiles);
    // End of Event Listener of the button element with id attribute id="uploadButton"

    function uploadFiles(event) 
        {   alert("Hello");
            event.preventDefault();
            // First, we get the files that were selected
            const form = document.querySelector('#uploadForm');
            const fileInput = document.getElementById("fileInput");
            const outputBox = form.querySelector('.result')

            const selectedFiles = fileInput.files; // put selected file in Array 
            // Second Check if any files are selected with some error-handling logic 
            // to cover the case of no files being selected.
                if (selectedFiles.length === 0) // check if there is files selected 
                    {
                    alert("Please select at least one file to upload.");
                    return;
                    } 

                else{  
            

        // Working with outputBox variabil which represent the result HTML element...
        outputBox.querySelector('.file-name').textContent = selectedFiles[0].name;
        outputBox.querySelector('.file-size').textContent = `${(selectedFiles[0].size / 1024).toFixed(2)} KB`;
        outputBox.querySelector('.upload-result').innerHTML = ` <i class="ph ph-circle-notch"></i> `;
        outputBox.style.display = 'flex';

            // Third Create a FormData object to store the form data
            const formData = new FormData(form);
            // Append each selected file to the FormData object
             //   for (let i = 0; i < selectedFiles.length; i++) 
              //      {
                 //   formData.append("files[]", selectedFiles[i]);
              //      }

            // Fourth Send the AJAX request using XMLHttpRequest
            const xhr = new XMLHttpRequest();
            xhr.open("POST",form.action);
            xhr.upload.onprogress = (event) => {
                const progress = (event.loaded / event.total) * 100;
                outputBox.querySelector('.progress').style.width = `${progress}%`;
            }

            xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                // Handle successful response from the server
                console.log('Files uploaded successfully!');
              //  alert("Files uploaded successfully!");
              outputBox.querySelector('.upload-result').innerHTML = `
              <span>${xhr.responseText}</span>
              <i class="ph ph-check-circle"></i>
            `
                } else {
                // Handle error response from the server
                console.error('Failed to upload files.');
              //  alert("Error occurred during file upload. Please try again.");
              outputBox.querySelector('.upload-result').innerHTML = `
              <span>${xhr.responseText}</span>
              <i class="ph ph-x-circle"></i>
            `

                }
            }
            };
            xhr.send(formData);

                    } // End else

        }
    


  </script>
   

</body>
</html>